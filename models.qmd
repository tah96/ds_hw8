---
title: "Modeling For Data Science"
format: html
editor: visual
---

## Reading in Libraries and our data

We'll first read in our libraries and our dataset of interest

```{r}
library(tidyverse)
library(tidymodels)
library(parsnip)
library(lubridate)

bike_data <- read_csv(file='data/SeoulBikeData.csv',show_col_types=FALSE)
head(bike_data)
```

## Exploratory Data Ananlyses

Before building our models, we want to get familiar with our data and perform some non-transformative data transformations if needed.

Lets check for the missing values in our data...The good news is there are no missing values!

```{r}
colSums(is.na(bike_data))
```

Lets check the column types to make sure they make sense along with some sample values. A few things we notice:

1.  Date is read in as `character` type. We will want to update this to numeric or date type
2.  There are four Seasons. Winter, Sprint, Fall and Summer.
3.  Holiday and Functioning Day attributes could be used as boolean if needed. They only hold 2 values

```{r}
str(bike_data)
```
Diving a level further, lets make sure all of our numeric columns where we should only expect values greater than zero follow that pattern. We will also want to make sure our assumption on values for Seasons, Holiday and Functioning Day hold true.

Everything seems to look good per the output below

```{r}
numColsInterest <- list(rented_bike <- bike_data$`Rented Bike Count`,
                        hour <- bike_data$Hour,
                        humid <- bike_data$`Humidity(%)`,
                        wind <- bike_data$`Wind speed (m/s)`,
                        vis <- bike_data$`Visibility (10m)`,
                        solar <- bike_data$`Solar Radiation (MJ/m2)`,
                        rain <- bike_data$`Rainfall(mm)`,
                        snow <- bike_data$`Snowfall (cm)`
                        
)

catColsInterest <- list(seasons_unique = unique(bike_data$Seasons),
                        holiday_unique = unique(bike_data$Holiday),
                        day_unique = unique(bike_data$`Functioning Day`))

catColsInterest

numMins <- lapply(numColsInterest,min)
str(numMins)
```
We want a series of transformations and renamings. We want the `Date` column in a data format. We want `Seasons`,`Holiday`,`Functioning Day` as factors. We also want to rename all of our columns so they're easier to work with using camel_case format.

We can see everything reflected in our structure output.

```{r}
bike_data <- bike_data %>%
  mutate(Date = dmy(Date),
         Seasons = as.factor(Seasons),
         Holiday = as.factor(Holiday),
         `Functioning Day` = as.factor(`Functioning Day`)
         ) %>%
  rename(date = Date,
         rented_bike_count = `Rented Bike Count`,
         hour = Hour,
         temperature_c = `Temperature(C)`,
         humidity_perc = `Humidity(%)`,
         wind_speed_ms = `Wind speed (m/s)`,
         visibility = `Visibility (10m)`,
         dew_temp = `Dew point temperature(C)`,
         solar_radiation = `Solar Radiation (MJ/m2)`,
         rainfall_mm = `Rainfall(mm)`,
         snowfall_cm = `Snowfall (cm)`,
         season = Seasons,
         holiday = Holiday,
         func_day = `Functioning Day`
         )

str(bike_data)
```
We want to create some summary statistics. We want to look our our `rented_bike_count` across our categorical variables `season`, `holiday` and `func_day`.

One major thing that stands out is ______.

```{r}
bike_summaries <- list(general=NULL, season = NULL, holiday = NULL, func_day = NULL)

summarizeNumeric <- function(data,catVar){
  catSym <- sym(catVar)
  summary_data <- bike_data %>%
    select(rented_bike_count,!!catSym) %>%
    group_by(!!catSym) %>%
    summarize(across(everything(), .fns = list("mean" = mean,
                                                 "median" = median,
                                                 "var" = var,
                                                 "sd" = sd,
                                                 "IQR" = IQR), .names = "{.fn}_{.col}"))
  return(summary_data)
}


bike_summaries$season <- summarizeNumeric(bike_data,"season")
bike_summaries$holiday <- summarizeNumeric(bike_data,"holiday")
bike_summaries$func_day <- summarizeNumeric(bike_data,"func_day")

bike_summaries$general <- bike_data %>%
  select(rented_bike_count) %>%
  summarize(across(everything(), .fns = list("mean" = mean,
                                                 "median" = median,
                                                 "var" = var,
                                                 "sd" = sd,
                                                 "IQR" = IQR), .names = "{.fn}_{.col}"))

bike_summaries


```

